---
title: UML 统一建模语言
date: 2022-02-05 22:52:52
tags:
    - UML
---

`UML` 是一种开放的方法，用于说明、可视化、构建和编写一个正在开发的、面向对象的、软件密集系统的制品的开放方法。UML展现了一系列最佳工程实践，这些最佳实践在对大规模，复杂系统进行建模方面，特别是在软件架构层次已经被验证有效。

{% asset_img uml-language.png %}

<!-- more -->


### 类图

面向对象程序设计(Object-Oriented Programming， 缩写为 `OOP`) 是一种范式， 其基本理念是将数据块及与数据相关的行为封装成为特殊的、 名为对象的实体， 同时对象实体的生成工作则是基于程序员给出的一系列蓝图， 这些蓝图就是类，在UML中，类图专门是用来描述这种实体的。如下图所示：

![类图-猫](class-cat.png)

类之间是有相互关系的，就像猫属于动物，动物和植物又属于生物体：

![类之间的层次结构](class-level.png)

类之间的关系可以更细分的划分为这几种：依赖，关联，聚合，组合。

#### 依赖

依赖是类之间最基础的、也是最微弱的关系类型。 如果修改一个类的定义可能会造成另一个类的变化，那么这两个类之 间就存在依赖关系。当你在代码中使用具体类的名称时， 通 常意味着存在依赖关系。 例如在指定方法签名类型时， 或是通过调用构造函数对对象进行初始化时等。 通过让代码依赖接口或抽象类(而不是具体类)，你可以降低其依赖程度。

通常情况下，UML 图不会展示所有依赖——它们在真实代码中的数量太多了。 为了不让依赖关系破坏 UML 图， 你必须对其进行精心选择，仅展示那些对于沟通你的想法来说重要 的依赖关系。

在UML中，依赖关系用一个虚线的箭头表示，从依赖者到被依赖者，例如教授依赖课程资料：

![授依赖于课程资料](class-depend.png)

#### 关联

关联是一个对象使用另一对象或与另一对象进行交互的关系。 在 UML 图中， 关联关系用起始于一个对象并指向其所使用 的对象的简单箭头来表示。 顺带一提， 双向关联也是完全正常的， 这种情况就用双向箭头来表示。 关联可视为一种特殊类型的依赖，即一个对象总是拥有访问与其交互的对象的权限，而简单的依赖关系并不会在对象间建立永久性的联系。

一般来说， 你可以使用关联关系来表示类似于类成员变量的东西。这个关系将一直存在，因此你总能通过`订单`来获 取其`顾客`。 但是它并非一定是成员变量。如果你根据接口来创建类，它也可以表示为一个可返回`订单`的`顾客`的方法。

为了区分关联和依赖，举如下的例子，`Professor` 依赖 `Course` 提供的 `c.getKnowledge` 方法获取知识，将其传授给关联的 `Student`：

```
class Professor is
    field Student student //...
    method teach(Course c) is
    // ...
    this.student.remember(c.getKnowledge())
```

如果有人修改了 课程 类的 getKnowledge (获取知识)方法(修改方法名或添加一些 必须的参数等)，代码将会崩溃。这就是依赖关系。

让我们来看看名为 `student` (学生)的成员变量，以及如何在 `teach` 方法中使用该变量。我们可以肯定学生 (`Student`)类是教授类的依赖: 如果 `remember` 方法被修改， 教授的代码也将崩溃。但由于教授的所有方法总能访问 `student` 成员变量，所以学生类就不仅是依赖，而也是关联了。

UML图中，经常用一个单向的箭头表示关联关系：

![](class-association.png)

#### 聚合

聚合是一种特殊类型的关联， 用于表示多个对象之间的`一对多`、`多对多`或`整体对部分`的关系 。 普通关联仅用于描述两个对象之间的关系。通常在聚合关系中， 一个对象`拥有` 一组其他对象， 并扮演着容器或集合的角色。组件可以独立于容器存在， 也可以同时连接多个容器。 在 UML 图中，聚合关系使用一端是空心菱形，另一端指向组件的箭头来表示。

![院系包含教授](class-juhe.png)


#### 组合

组合是一种特殊类型的聚合， 其中一个对象由一个或多个其他对象实例构成。 组合与其他关系的区别在于组件仅能作为容器的一部分存在。 在 `UML` 图中，组合与聚合关系的符号相同，但箭头起始处的菱形是实心的。

![大学由院系构成](class-zuhe.png)


### OOP

面向对象程序设计的四个基本概念使其区别于其他程序设计范式，他们分别是：抽象，多态，封装以及继承。

#### 抽象

当使用面向对象程序设计的理念开发一款程序时， 我们会将大部分时间用于根据真实世界对象来设计程序中的对象。但是，程序中的对象并不需要能够百分之百准确地反映其原型(极少情况下才需要做到这一点)。实际上，你的对象只需模拟真实对象的特定属性和行为即可，其他内容可以忽略。

例如， 飞行模拟器和航班预订程序中都可能会包含一个飞机 `Airplane` 类。 但是前者需包含与实际飞行相关的详细信息，而后者则只关心座位图和哪些座位可供预订。

![同一个真实世界对象的不同模型。](class-airplane.png)

抽象是一种反映真实世界对象或现象中特定内容的模型， 它 能高精度地反映所有与特定内容相关的详细信息， 同时忽略其他内容。


#### 封装

封装是指一个对象对其他对象隐藏其部分状态和行为， 而仅向程序其他部分暴露有限的接口的能力。

如果想要启动一辆车的发动机， 你只需转动钥匙或按下按钮即可， 无需打开引擎盖手动接线、转动曲轴和气缸并启动发动机的动力循环。 这些细节都隐藏在引擎盖下，你只会看到一些简单的接口: 启动开关、方向盘和一些踏板。 

对象的接口——它是对象的公有部分，能够同其他对象进行交互。

封装某个内容意味着使用关键字 `private` 来对其进行修饰， 这样仅有其所在类中的方法才能访问这些内容。 还有一种限制程度较小的关键字 `protected` 保护 ， 其所修饰的对象仅允许父类访问其类中的成员。

绝大部分编程语言的接口和抽象类(或方法)都基于抽象和 封装的概念。 在现代面向对象的编程语言中， 接口机制(通常使用 `interface` 或 `protocol` 关键字来声明)允许你定义对象之间的交互协议。这也是接口仅关心对象行为，以及你不能在接口中声明成员变量的原因之一。

假如航空运输 `FlyingTransport` 接口中有一个 `fly(origin, destination, passengers)` 方法 (即以起点、 终点以及乘客为参数的飞行方法)。 在设计航空运输模拟器时， 你可以对机场 `Airport` 做出限制， 使其仅与实现了航空运输接口的对象进行交互。此后，你可以确保 传递给机场对象的任何对象——无论是`飞机`、 `直升机`、还是可怕的`家养狮鹫` —— 都能到达或离开这种类型的机场。

![多个类实现一个接口的 UML 图](class-inbox.png)

#### 继承

继承是指在根据已有类创建新类的能力。 继承最主要的好处是代码复用。如果你想要创建的类与已有的类差异不大， 那也没必要重复编写相同的代码。你只需扩展已有的类并将额外功能放入生成的子类(它会继承父类的成员变量和方法) 中即可。

使用继承后，子类将拥有与其父类相同的接口。如果父类中声明了某个方法，那么你将无法在子类中隐藏该方法。你还必须实现所有的抽象方法，即使它们对于你的子类而言没有意义。

![多个类实现一个接口的 UML 图](class-jicheng.png)

在绝大多数编程语言中， 子类仅能对一个父类进行扩展。 另一方面， 任何类都可以同时实现多个接口。 但是正如我之前提到的那样， 如果父类实现了某个接口， 那么其所有子类都 必须实现该接口。

#### 多态

绝大部分动物 `Animals` 可以发出声音。 我们需要所有子类都重写基类的 `makeSound` 发出声音方法，让每个子类都发出正确的声音，因此我们可以马上将其声明为抽象。 这让我们得以忽略父类中该方法的所有默认实现，从而强制要求所有子类自行提供该方法的实现。

![](class-polymorphism.png)

假如将几只猫和狗放入一个大袋子中。 然后，我们闭上眼睛，将动物一个一个地从袋中取出。 我们并不知道自己取出的是何种动物。 但如果我们好好地摸摸它们的话， 它就会根据自己的具体类发出特殊的欢快叫声。

```
bag = [new Cat(), new Dog()]; 
foreach (Animal a : bag)
    a.makeSound()

//喵喵!
//汪汪!
```

程序并不知道 `a` 变量中所包含的对象的具体类型，但幸亏有被称为多态的特殊机制， 程序可以追踪对象的子类并调用其方法，从而执行恰当的行为。

多态是指程序能够检测对象所属的实际类，并在当前上下文不知道其真实类型的情况下调用其实现的能力。


### UML

UML图经过各种大型工程的实践，被证明是一种极其有用的方式来描述可视化系统，数据可系统及其他软件系统，所有的软件开发人员都应该学习并掌握它。从种类上来说，它有以下几种类型：

![UML图种类](UML图种类.png)


#### 类图（Class Diagram）

`Class` 经常被用用来描述某个具体的或者抽象的对象，这个对象经常具有一些属性和方法，而且这些属性和方法都具有不同的访问限制规则，例如一个用来描述 `Dog` 的类图：

![](UML-Class-dog.png)

可以看到的是在每个属性或者方法之前都有一个 `+` 或者 `-`，这个就是访问限制规则，一共有四种：

- `+`：Public，可公开访问
- `-`：Private
- `#`：Protected
- `~`：Package Local

而且对于方法而言，可以通过 `in`，`inout` 或者 `out` 标识参数的意义：

- `in`: 该参数仅作为输入参数，不应该被修改；
- `inout`: 该参数即可作为输入参数，也可以被内部修改；
- `out`: 该参数仅用于作为输出参数存储库，就像传入一个地址，然后内部可以对其进行赋值；

![](UML-Class-myclass.png)

就像现实世界中不同对象之间有不同的关系一样，类图中也有描述不同类之间关系的方式，一般存在六种关系，分别是关联，继承，实现，依赖，聚合和组合。

例如，学生从老师那里学习知识，这种关系就可以表示位简单的关联关系，在表示的时候使用一个联系表示即可，也可以适当添加描述信息：

![](UML-Class-student-tutor.png)

继承有时候也可以称为泛化，用一个空心箭头从子类指向父类，父类可能是抽象类或者具体类：

![](UML-Class-relation-inherit.png)

实现一般是指具体类型和接口之间关系，用一个虚线实心箭头表示：

![](UML-Class-relationships-realization.png)

当一个对象在其方法中使用另一个类的对象，并且未存储在任何字段中时，就表示存在依赖关系，例如，`Person` 有一个方法 `Read` 接收一个 `Book` 的实例 `book` 作为参数，调用 `Book` 的 `getknowledge` 方法获取知识：

![](UML-Class-relationships-dependency.png)

聚合和组合比较相近，都表示一对多的关系，而聚合通常用来表示用类的聚合，而组合表示整体和部分的关系；例如学校有很多老师，这种表示聚合关系；而学校也有很多不同的学院，计算机学院，土木工程等，这种表示组合关系，不同类型；在表示上聚合使用空心菱形箭头，组合使用实心菱形箭头表示。

![](UML-Class-relationships-aggr-composition.png)


### 参考资料

1. [UML Diagrams Full Course (Unified Modeling Language)](https://www.youtube.com/watch?v=WnMQ8HlmeXc)